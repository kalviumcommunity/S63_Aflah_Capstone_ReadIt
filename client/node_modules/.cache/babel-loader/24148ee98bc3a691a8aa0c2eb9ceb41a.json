{"ast":null,"code":"import authService from '../services/auth';\nimport userService from '../services/user';\nimport storageService from '../utils/localStorage';\nconst userReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'LOGIN':\n      return action.payload;\n    case 'SIGNUP':\n      return action.payload;\n    case 'LOGOUT':\n      return null;\n    case 'SET_USER':\n      return action.payload;\n    case 'SET_AVATAR':\n      return {\n        ...state,\n        ...action.payload\n      };\n    case 'REMOVE_AVATAR':\n      return {\n        ...state,\n        avatar: {\n          exists: false\n        }\n      };\n    default:\n      return state;\n  }\n};\nexport const loginUser = credentials => {\n  return async dispatch => {\n    const user = await authService.login(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n    dispatch({\n      type: 'LOGIN',\n      payload: user\n    });\n  };\n};\nexport const signupUser = credentials => {\n  return async dispatch => {\n    const user = await authService.signup(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n    dispatch({\n      type: 'SIGNUP',\n      payload: user\n    });\n  };\n};\nexport const logoutUser = () => {\n  return dispatch => {\n    storageService.logoutUser();\n    authService.setToken(null);\n    dispatch({\n      type: 'LOGOUT'\n    });\n  };\n};\nexport const setUser = () => {\n  return dispatch => {\n    const loggedUser = storageService.loadUser();\n    if (loggedUser) {\n      authService.setToken(loggedUser.token);\n      dispatch({\n        type: 'SET_USER',\n        payload: loggedUser\n      });\n    }\n  };\n};\nexport const setAvatar = avatarImage => {\n  return async dispatch => {\n    const uploadedAvatar = await userService.uploadAvatar({\n      avatarImage\n    });\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({\n      ...prevUserData,\n      ...uploadedAvatar\n    });\n    dispatch({\n      type: 'SET_AVATAR',\n      payload: uploadedAvatar\n    });\n  };\n};\nexport const deleteAvatar = () => {\n  return async dispatch => {\n    await userService.removeAvatar();\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({\n      ...prevUserData,\n      avatar: {\n        exists: false\n      }\n    });\n    dispatch({\n      type: 'REMOVE_AVATAR'\n    });\n  };\n};\nexport default userReducer;","map":{"version":3,"names":["authService","userService","storageService","userReducer","state","action","type","payload","avatar","exists","loginUser","credentials","dispatch","user","login","saveUser","setToken","token","signupUser","signup","logoutUser","setUser","loggedUser","loadUser","setAvatar","avatarImage","uploadedAvatar","uploadAvatar","prevUserData","deleteAvatar","removeAvatar"],"sources":["/Users/aflahhaami/S63_Aflah_Capstone_ReadIt/client/src/reducers/userReducer.js"],"sourcesContent":["import authService from '../services/auth';\nimport userService from '../services/user';\nimport storageService from '../utils/localStorage';\n\nconst userReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'LOGIN':\n      return action.payload;\n    case 'SIGNUP':\n      return action.payload;\n    case 'LOGOUT':\n      return null;\n    case 'SET_USER':\n      return action.payload;\n    case 'SET_AVATAR':\n      return { ...state, ...action.payload };\n    case 'REMOVE_AVATAR':\n      return { ...state, avatar: { exists: false } };\n    default:\n      return state;\n  }\n};\n\nexport const loginUser = (credentials) => {\n  return async (dispatch) => {\n    const user = await authService.login(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n\n    dispatch({\n      type: 'LOGIN',\n      payload: user,\n    });\n  };\n};\n\nexport const signupUser = (credentials) => {\n  return async (dispatch) => {\n    const user = await authService.signup(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n\n    dispatch({\n      type: 'SIGNUP',\n      payload: user,\n    });\n  };\n};\n\nexport const logoutUser = () => {\n  return (dispatch) => {\n    storageService.logoutUser();\n    authService.setToken(null);\n\n    dispatch({\n      type: 'LOGOUT',\n    });\n  };\n};\n\nexport const setUser = () => {\n  return (dispatch) => {\n    const loggedUser = storageService.loadUser();\n\n    if (loggedUser) {\n      authService.setToken(loggedUser.token);\n\n      dispatch({\n        type: 'SET_USER',\n        payload: loggedUser,\n      });\n    }\n  };\n};\n\nexport const setAvatar = (avatarImage) => {\n  return async (dispatch) => {\n    const uploadedAvatar = await userService.uploadAvatar({ avatarImage });\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({ ...prevUserData, ...uploadedAvatar });\n\n    dispatch({\n      type: 'SET_AVATAR',\n      payload: uploadedAvatar,\n    });\n  };\n};\n\nexport const deleteAvatar = () => {\n  return async (dispatch) => {\n    await userService.removeAvatar();\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({ ...prevUserData, avatar: { exists: false } });\n\n    dispatch({\n      type: 'REMOVE_AVATAR',\n    });\n  };\n};\n\nexport default userReducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}